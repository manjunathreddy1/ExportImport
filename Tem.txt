Export:
Connect-PnPOnline -Url "https://m365x37427303.sharepoint.com/sites/contentTypeHub" -UseWebLogin
$contentType = Get-PnPContentType -Identity "POC-Hub"
$contentType.SchemaXml | Out-File "C:\Users\DELL\Documents\Projects\Manju\POC-Hub.xml"


















#Function to Import the Content Type in SharePoint Online using powershell
Function Import-PnPContentType
{
    param
    (
        [string]$SiteURL  = $(throw "Enter the Site URL!"),      
        [string]$ImportFile = $(throw "Enter the File to Import!")
    )
    Try {
        #Connect to SharePoint Online
        Connect-PnPOnline -Url $SiteURL -Interactive -ClientId "553a6b41-d10f-418b-be9d-4ba848607c04"

#Import the XML File
$ContentTypeXML = [xml](Get-Content($ImportFile))
$ContentTypeName = $ContentTypeXML.ContentType.Name

        #Check if the content type to exists already
        $ContentType = Get-PnPContentType -Identity $ContentTypeName -ErrorAction SilentlyContinue
         
        If($ContentType -eq $Null)
        {
            #Create the content type
            $ContentType = Add-PnPContentType -Name $ContentTypeName -Description $ContentTypeXML.ContentType.Description -Group $ContentTypeXML.ContentType.Group            
            Write-host "Content Type '$ContentTypeName' Created Successfully!" -ForegroundColor Green
 
            Write-host "Adding Fields to the Content Type..." -ForegroundColor Yellow
            #Remove the "Version" Attribute from the XML
            $ContentTypeXML.ContentType.Fields.Field.RemoveAttribute("Version")
             
            #Add Fields to content type
            ForEach($Field in $ContentTypeXML.ContentType.Fields.Field)
            {
                #Get existing fields from content type
                $ContentTypeFields = Get-PnPProperty -ClientObject $ContentType -Property Fields
                 
                #Check if the content type has the field already!
                $ContentTypeField = $ContentTypeFields | Where {$_.InternalName -eq $Field.Name}
                If($ContentTypeField -eq $Null)
                {
                    #Get the site column
                    $SiteColumn = Get-PnPField | Where {$_.InternalName -eq $Field.Name}
                    If($SiteColumn -eq $Null)
                    {
                        #Add Site column to Web
                        Add-PnPFieldFromXml -FieldXml $Field.OuterXml
                        Write-host "Site Column Added:" $($Field.Name)
                    }
                    Else
                    {
                        Write-host -f Yellow "`tSite Column '$($Field.Name)' Already Exists.. Skipping Creating site column"
                    }
 
                    #get the field to add to content type
                    $SiteColumn = Get-PnPField | Where {$_.InternalName -eq $Field.Name}
                    #Add Field to Content type
                    Add-PnPFieldToContentType -Field $SiteColumn -ContentType $ContentTypeName
 
                    Write-host "`tField '$($Field.Name)' Added to Content Type" -Foregroundcolor Green
                }
            }
            write-host "Content Type '$ContentTypeName' Imported Successfully!" -ForegroundColor  Green
        }
        else
        {            
            Write-Host "Content Type '$ContentTypeName' Already Exist in the Site!" -ForegroundColor Yellow
        }
    }
    Catch {
        write-host -f Red "Error Importing Content Type!" $_.Exception.Message
    }
}
 
#Variables
$SiteURL = "https://testspdomain.sharepoint.com/sites/contenttypehub"
$ImportFile = "C:\Scripts\POC-Hub.xml"
 
#Call the function to Import the content type
Import-PnPContentType -SiteURL $SiteURL -ImportFile $ImportFile
